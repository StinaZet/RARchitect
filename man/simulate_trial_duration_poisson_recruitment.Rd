% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_trial_duration_poisson_recruitment.R
\name{simulate_trial_duration_poisson_recruitment}
\alias{simulate_trial_duration_poisson_recruitment}
\title{Simulate Trial Durations with Poisson Recruitment and Variable Block Sizes}
\usage{
simulate_trial_duration_poisson_recruitment(
  N,
  block_sizes,
  poisson_recruitment_rate_per_unit_time,
  outcome_observation_delay_per_patient,
  num_simulations
)
}
\arguments{
\item{N}{Numeric. Total sample size for the trial. Must be equal to \code{sum(block_sizes)}.}

\item{block_sizes}{Numeric vector. A vector where each element specifies the
size of a sequential recruitment block. The sum of all elements in \code{block_sizes}
must equal \code{N}. All elements must be positive integers.}

\item{poisson_recruitment_rate_per_unit_time}{Numeric. The rate parameter (lambda)
for the Poisson process that governs patient recruitment. This is the average
number of patients arriving per unit of time (e.g., patients per month).
Inter-arrival times for patient recruitment are drawn from an exponential
distribution with this rate.}

\item{outcome_observation_delay_per_patient}{Numeric. The fixed time from a participant's
enrollment until their outcome is observed. For example, if 30, it takes
30 days for an outcome to be observed after a participant is enrolled.}

\item{num_simulations}{Integer. The number of times to run the simulation.
A higher number provides a more stable estimate of the average recruitment
and observation times for each participant and their variability.}
}
\value{
A data frame with \code{N} rows and the following columns:
\itemize{
\item \code{SubjectID}: The unique identifier for each participant (1 to N).
\item \code{EstimatedRecruitmentTime}: The average time point at which each participant
is recruited, estimated across all simulation runs.
\item \code{StdDevRecruitmentTime}: The standard deviation of recruitment times
for each participant across all simulation runs. If \code{num_simulations} is 1,
this will be 0.
\item \code{EstimatedObservationTime}: The average time point at which each participant's
outcome is observed, estimated across all simulation runs.
\item \code{StdDevObservationTime}: The standard deviation of observation times
for each participant across all simulation runs. If \code{num_simulations} is 1,
this will be 0.
}
If \code{N} is 0, an empty data frame with the specified columns is returned.
The estimated total trial duration can be obtained by taking \code{max(EstimatedObservationTime)}
from the returned data frame.
}
\description{
Simulates the total duration of a clinical trial multiple times, accounting for
patient recruitment following a Poisson process (meaning inter-arrival times
are exponentially distributed) and a fixed time for outcome observation.
Recruitment occurs in sequential blocks of potentially different sizes,
and a new block can only begin enrollment after all participants from the
previous block have been fully enrolled and their outcomes observed.
This function returns the estimated (average) recruitment and observation times
for each participant across all simulations, along with their standard deviations.
}
\examples{
# Example 1: Fixed block size (same as previous behavior, but using vector)
set.seed(123) # For reproducibility
estimated_times_1 <- simulate_trial_duration_poisson_recruitment(
N = 200,
block_sizes = rep(10, 20), # 20 blocks of 10 patients each
poisson_recruitment_rate_per_unit_time = 5,
outcome_observation_delay_per_patient = 30,
num_simulations = 1000
)
estimated_total_duration_1 <- max(estimated_times_1$EstimatedObservationTime)
print(estimated_total_duration_1)
head(estimated_times_1)
summary(estimated_times_1$StdDevRecruitmentTime) # Check variability

# Example 2: Variable block sizes
set.seed(456)
estimated_times_2 <- simulate_trial_duration_poisson_recruitment(
N = 100,
block_sizes = c(10, 15, 20, 25, 30), # Sum is 100
poisson_recruitment_rate_per_unit_time = 10,
outcome_observation_delay_per_patient = 15,
num_simulations = 500
)
estimated_total_duration_2 <- max(estimated_times_2$EstimatedObservationTime)
print(estimated_total_duration_2)
tail(estimated_times_2)
summary(estimated_times_2$StdDevObservationTime) # Check variability

# Example 3: Single patient trial, single simulation (StdDev will be 0)
set.seed(789)
estimated_times_3 <- simulate_trial_duration_poisson_recruitment(
N = 1,
block_sizes = c(1), # Single block of 1 patient
poisson_recruitment_rate_per_unit_time = 2,
outcome_observation_delay_per_patient = 10,
num_simulations = 1
)
estimated_total_duration_3 <- max(estimated_times_3$EstimatedObservationTime)
print(estimated_total_duration_3)
print(estimated_times_3)
}
